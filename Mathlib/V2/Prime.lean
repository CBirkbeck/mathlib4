import Mathlib.V2.Certify

-- basic certificates
example : Nat.Prime 19 := by pratt mathematica {19, 2, {2, {3, 2, {2}}}}
example : Nat.Prime 19 := by pratt builder [2, (3, 2, [2]), (19, 2, [2, 3])]
example : Nat.Prime 37 := by pratt mathematica {37, 2, {2, {3, 2, {2}}}}
example : Nat.Prime 37 := by pratt builder [2, (3, 2, [2]), (37, 2, [2, 3])]
example : Nat.Prime 53 := by pratt mathematica {53, 2, {2, {13, 2, {2, {3, 2, {2}}}}}}
example : Nat.Prime 53 := by pratt builder [2, (3, 2, [2]), (13, 2, [2, 3]), (53, 2, [2, 13])]
example : Nat.Prime 97 := by pratt mathematica {97, 5, {2, {3, 2, {2}}}}
example : Nat.Prime 97 := by pratt builder [2, (3, 2, [2]), (97, 5, [2, 3])]

-- hide the really small primes
example : Nat.Prime 101 := by pratt mathematica {101, 2, {2, {5, 2, {2}}}}
example : Nat.Prime 101 := by pratt mathematica {101, 2, {2, 5}}
example : Nat.Prime 101 := by pratt builder [2, (5, 2, [2]), (101, 2, [2, 5])]
example : Nat.Prime 101 := by pratt builder [2, 5, (101, 2, [2, 5])]

example : Nat.Prime 103 := by pratt mathematica {103, 5, {2, 3, {17, 3, {2}}}}
example : Nat.Prime 103 := by pratt mathematica {103, 5, {2, 3, 17}}

example : Nat.Prime 107 := by pratt mathematica
  {107, 2, {2, {53, 2, {2, {13, 2, {2, {3, 2, {2}}}}}}}}
example : Nat.Prime 107 := by pratt mathematica {107, 2, {2, 53}}

-- the tactic helps you find the certificate (a bit)
example : Nat.Prime 109 := by pratt mathematica {109, 6, {2, 3}}
example : Nat.Prime 113 := by pratt mathematica {113, 3, {2, 7}}
example : Nat.Prime 127 := by pratt mathematica {127, 3, {2, 3, 7}}
example : Nat.Prime 1270249 := by pratt
  mathematica {1270249, 11, {2, 3, 7, {7561, 13, {2, 3, 5, 7}}}}

example : Nat.Prime 1270249 := by pratt
  builder [2, 3, 5, 7, (7561, 13, [2, 3, 5, 7]), (1270249, 11, [2, 3, 7, 7561])]

example : Nat.Prime 101 := by pratt
  builder [2, 5, (101, 2, [2, 5])]

-- or you can ask mathematica!
example : Nat.Prime 1873 := by pratt mathematica {1873, 10, {2, 3, 13}}
example : Nat.Prime 1873 := by pratt builder [2, 3, 13, (1873, 10, [2, 3, 13])]
example : Nat.Prime 1873 := by pratt builder [2, 3, 13, (1873, 10, [2, 3, 13])]

example : Nat.Prime 47867742232066880047611079 := by
  pratt
    mathematica
      {47867742232066880047611079, 3, {2, 3, 7, 29, {62311, 6, {2, 3, 5, 31, 67}},
        {90101681149415123, 2, {2, 11, 17, {214499, 2, {2, 23, {4663, 3, {2, 3, 7, 37}}}},
          {1123145497, 7, {2, 3, 11, {283, 3, {2, 3, 47}},
            {5011, 2, {2, 3, 5, {167, 5, {2, 83}}}}}}}}}}

example : Nat.Prime 47867742232066880047611079 := by
  pratt
    builder
      [2, 3, 5, 7, 11, 17, 23, 29, 31, 37, 47, 67, 83, (167, 5, [2, 83]), (283, 3, [2, 3, 47]),
        (4663, 3, [2, 3, 7, 37]), (5011, 2, [2, 3, 5, 167]), (62311, 6, [2, 3, 5, 31, 67]),
        (214499, 2, [2, 23, 4663]), (1123145497, 7, [2, 3, 11, 283, 5011]),
        (90101681149415123, 2, [2, 11, 17, 214499, 1123145497]),
        (47867742232066880047611079, 3, [2, 3, 7, 29, 62311, 90101681149415123])]

example : Nat.Prime 47867742232066880047611079 := by
  pratt
    builder
      [2, 3, 5, 7, 11, 17, 23, 29, 31, 37, 47, 67, 83, (167, 5, [2, 83]), (283, 3, [2, 3, 47]),
        (4663, 3, [2, 3, 7, 37]), (5011, 2, [2, 3, 5, 167]), (62311, 6, [2, 3, 5, 31, 67]),
        (214499, 2, [2, 23, 4663]), (1123145497, 7, [2, 3, 11, 283, 5011]),
        (90101681149415123, 2, [2, 11, 17, 214499, 1123145497]),
        (47867742232066880047611079, 3, [2, 3, 7, 29, 62311, 90101681149415123])]


-- example : Nat.Prime 373 := by prime (generator := .mathematica)

-- -- 605185576317848261+155368778*23#*n for n=0..26 found by MooMoo2 (Michael Kwok) on 2023-12-10 09:53:34 UTC and verified by Davina
-- -- 277699295941594831+170826477*23#*n for n=0..26 found by tng on 2023-05-26 01:04:36 UTC and verified by zvasi_000 (Official Announcement)
-- -- 224584605939537911+81292139*23#*n for n=0..26 found by robish on 2019-09-23 06:25:41 UTC and verified by [DPC] hansR (Official Announcement)

lemma green_tao_27 : ∀ i < 27, Nat.Prime (224584605939537911 + 18135696597948930 * i) := by
  simp only [Nat.lt_succ_iff_lt_or_eq, not_lt_zero', false_or, or_assoc, Nat.reduceMul,
    forall_eq_or_imp, mul_zero, add_zero, mul_one, Nat.reduceAdd, forall_eq]
  repeat' apply And.intro
  · pratt builder
      [2, 3, 5, 11, 23, 29, 37, 79, (2371, 2, [2, 3, 5, 79]), (5107, 2, [2, 3, 23, 37]),
        (5569, 13, [2, 3, 29]), (30643, 2, [2, 3, 5107]), (29693250859, 2, [2, 3, 29, 5569, 30643]),
        (224584605939537911, 7, [2, 5, 11, 29, 2371, 29693250859])]
  · pratt builder
      [2, 3, 5, 7, 11, 59, 73, 89, (439, 15, [2, 3, 73]), (463, 3, [2, 3, 7, 11]),
        (51803, 2, [2, 59, 439]), (310819, 2, [2, 3, 51803]),
        (105053713811, 2, [2, 5, 73, 463, 310819]),
        (242720302537486841, 3, [2, 5, 11, 59, 89, 105053713811])]
  · pratt builder
      [2, 5, 11, 13, 19, 23, 29, 67, (599, 7, [2, 13, 23]), (4793, 3, [2, 599]),
        (6701, 2, [2, 5, 67]), (97151, 13, [2, 5, 29, 67]), (1943021, 2, [2, 5, 97151]),
        (73834799, 11, [2, 19, 1943021]), (260855999135435771, 2, [2, 5, 11, 4793, 6701, 73834799])]
  · pratt builder
      [2, 3, 5, 7, 11, 73, 89, (127, 3, [2, 3, 7]), (439, 15, [2, 3, 73]),
        (19559, 13, [2, 7, 11, 127]), (39119, 11, [2, 19559]), (6483519883, 2, [2, 3, 7, 89, 439]),
        (278991695733384701, 2, [2, 5, 11, 39119, 6483519883])]
  · pratt builder
      [2, 3, 5, 11, 17, 19, 59, 97, (389, 2, [2, 97]), (2243, 2, [2, 19, 59]),
        (7481, 6, [2, 5, 11, 17]), (1492021171, 11, [2, 3, 5, 19, 389, 2243]),
        (32824465763, 2, [2, 11, 1492021171]),
        (297127392331333631, 7, [2, 5, 11, 7481, 32824465763])]
  · pratt builder
      [2, 3, 5, 11, 13, 17, 19, (109, 6, [2, 3]), (191, 19, [2, 5, 19]), (383, 5, [2, 191]),
        (4597, 5, [2, 3, 383]), (9127, 3, [2, 3, 13]), (51109447, 5, [2, 3, 17, 109, 4597]),
        (306656683, 5, [2, 3, 51109447]), (1226626733, 2, [2, 306656683]),
        (315263088929282561, 6, [2, 5, 11, 9127, 1226626733])]
  · pratt builder
      [2, 3, 5, 7, 11, 13, 29, 47, (251, 6, [2, 5]), (337, 10, [2, 3, 7]), (2069, 2, [2, 11, 47]),
        (37243, 2, [2, 3, 2069]), (422183, 5, [2, 29, 251]),
        (81381683813, 3, [2, 11, 13, 337, 422183]),
        (333398785527231491, 2, [2, 5, 11, 37243, 81381683813])]
  · pratt builder
      [2, 3, 5, 7, 11, 37, (223, 3, [2, 3, 37]), (433, 5, [2, 3]), (449, 3, [2, 7]),
        (1999, 3, [2, 3, 37]), (3593, 3, [2, 449]), (83094433, 5, [2, 3, 433, 1999]),
        (7165399146457, 7, [2, 3, 3593, 83094433]),
        (351534482125180421, 3, [2, 5, 11, 223, 7165399146457])]
  · pratt builder
      [2, 3, 5, 7, 11, 13, 19, 37, 41, (547, 2, [2, 3, 7, 13]), (601, 7, [2, 3, 5]),
        (1559, 19, [2, 19, 41]), (1777, 5, [2, 3, 37]), (17496343, 5, [2, 3, 547, 1777]),
        (369670178723129351, 7, [2, 5, 11, 41, 601, 1559, 17496343])]
  · pratt builder
      [2, 3, 5, 7, 11, 13, 17, 89, (101, 2, [2, 5]), (131, 2, [2, 5, 13]), (179, 2, [2, 89]),
        (271, 6, [2, 3, 5]), (607, 3, [2, 3, 101]), (14321, 3, [2, 5, 179]),
        (1113239, 7, [2, 7, 131, 607]), (1460743, 3, [2, 3, 17, 14321]),
        (2226479, 13, [2, 1113239]), (387805875321078281, 3, [2, 5, 11, 271, 1460743, 2226479])]
  · pratt builder
      [2, 3, 5, 7, 11, 13, 17, 47, (101, 2, [2, 5]), (151, 6, [2, 3, 5]), (607, 3, [2, 3, 101]),
        (1093, 5, [2, 3, 7, 13]), (3643, 2, [2, 3, 607]), (4373, 2, [2, 1093]),
        (104953, 5, [2, 3, 4373]), (145721, 3, [2, 5, 3643]), (3568403, 2, [2, 17, 104953]),
        (405941571919027211, 2, [2, 5, 11, 47, 151, 145721, 3568403])]
  · pratt builder
      [2, 3, 5, 7, 11, 31, 53, (107, 2, [2, 53]), (337, 10, [2, 3, 7]), (59707, 3, [2, 3, 31, 107]),
        (2149453, 5, [2, 3, 59707]), (478081336261, 2, [2, 3, 5, 11, 337, 2149453]),
        (22947904140529, 41, [2, 3, 478081336261]),
        (1927623947804437, 14, [2, 3, 7, 22947904140529]),
        (424077268516976141, 10, [2, 5, 11, 1927623947804437])]
  · pratt builder
      [2, 3, 5, 7, 11, 31, 37, 89, (179, 2, [2, 89]), (433, 5, [2, 3]), (1433, 3, [2, 179]),
        (1733, 2, [2, 433]), (10399, 6, [2, 3, 1733]), (1539053, 2, [2, 37, 10399]),
        (3232011301, 2, [2, 3, 5, 7, 1539053]), (64840610720663, 5, [2, 7, 1433, 3232011301]),
        (129681221441327, 5, [2, 64840610720663]),
        (442212965114925071, 7, [2, 5, 11, 31, 129681221441327])]
  · pratt builder
      [2, 3, 5, 7, 11, 13, 17, 73, (409, 21, [2, 3, 17]), (3067, 2, [2, 3, 7, 73]),
        (12269, 2, [2, 3067]), (53171, 2, [2, 5, 13, 409]), (94750723, 3, [2, 3, 11, 53171]),
        (20924939168767, 3, [2, 3, 12269, 94750723]),
        (460348661712874001, 12, [2, 5, 11, 20924939168767])]
  · pratt builder
      [2, 3, 5, 11, 37, 41, (149, 2, [2, 37]), (181, 2, [2, 3, 5]), (2953, 13, [2, 3, 41]),
        (7451, 2, [2, 5, 149]), (1092241, 11, [2, 3, 5, 37, 41]),
        (478484358310822931, 6, [2, 5, 11, 181, 2953, 7451, 1092241])]
  · pratt builder
      [2, 3, 5, 11, 23, 37, (139, 2, [2, 3, 23]), (223, 3, [2, 3, 37]), (251, 6, [2, 5]),
        (277, 5, [2, 3, 23]), (57731, 2, [2, 5, 23, 251]), (12832759, 3, [2, 3, 23, 139, 223]),
        (496620054908771861, 2, [2, 5, 11, 277, 57731, 12832759])]
  · pratt builder
      [2, 3, 5, 7, 11, 43, 53, 73, 83, (107, 2, [2, 53]), (193, 5, [2, 3]), (499, 7, [2, 3, 83]),
        (773, 2, [2, 193]), (77659, 2, [2, 3, 7, 43]), (7795379, 2, [2, 73, 107, 499]),
        (60258279671, 13, [2, 5, 773, 7795379]),
        (514755751506720791, 7, [2, 5, 11, 77659, 60258279671])]
  · pratt builder
      [2, 3, 5, 7, 11, 13, 17, 23, 53, (107, 2, [2, 53]), (131, 2, [2, 5, 13]),
        (157, 5, [2, 3, 13]), (263, 5, [2, 131]), (443, 2, [2, 13, 17]), (1289, 6, [2, 7, 23]),
        (8861, 2, [2, 5, 443]), (136679486233, 5, [2, 3, 107, 157, 263, 1289]),
        (532891448104669721, 3, [2, 5, 11, 8861, 136679486233])]
  · pratt builder
      [2, 3, 5, 11, 13, 59, (157, 5, [2, 3, 13]), (401, 3, [2, 5]), (433, 5, [2, 3]),
        (1181, 7, [2, 5, 59]), (3209, 3, [2, 401]), (5653, 5, [2, 3, 157]),
        (8336983, 3, [2, 3, 433, 3209]), (1001867535822943, 3, [2, 3, 1181, 5653, 8336983]),
        (551027144702618651, 2, [2, 5, 11, 1001867535822943])]
  · pratt builder
      [2, 3, 5, 7, 11, 17, (241, 7, [2, 3, 5]), (409, 21, [2, 3, 17]), (1409, 3, [2, 11]),
        (28523797, 2, [2, 3, 7, 241, 1409]), (2566571254061, 2, [2, 5, 11, 409, 28523797]),
        (2587103824093489, 11, [2, 3, 7, 2566571254061]),
        (569162841300567581, 3, [2, 5, 11, 2587103824093489])]
  · pratt builder
      [2, 3, 5, 11, 13, 19, 43, (191, 19, [2, 5, 19]), (257, 3, [2]), (487, 3, [2, 3]),
        (2237, 2, [2, 13, 43]), (2299637, 2, [2, 257, 2237]), (14510653, 2, [2, 3, 13, 191, 487]),
        (58042613, 2, [2, 14510653]), (5339077617259241, 3, [2, 5, 2299637, 58042613]),
        (587298537898516511, 11, [2, 5, 11, 5339077617259241])]
  · pratt builder
      [2, 3, 5, 7, 11, 17, 83, (337, 10, [2, 3, 7]), (919, 7, [2, 3, 17]), (20219, 2, [2, 11, 919]),
        (2685217, 5, [2, 3, 83, 337]), (5823073, 5, [2, 3, 20219]),
        (128107607, 10, [2, 11, 5823073]), (605434234496465441, 3, [2, 5, 11, 2685217, 128107607])]
  · pratt builder
      [2, 3, 5, 11, 17, 31, 97, (103, 5, [2, 3, 17]), (163, 2, [2, 3]), (619, 2, [2, 3, 103]),
        (1553, 3, [2, 97]), (1861, 2, [2, 3, 5, 31]), (3168721, 7, [2, 3, 5, 163]),
        (623569931094414371, 6, [2, 5, 11, 619, 1553, 1861, 3168721])]
  · pratt builder
      [2, 3, 5, 11, 17, 19, 29, 37, 53, (109, 6, [2, 3]), (149, 2, [2, 37]), (229, 6, [2, 3, 19]),
        (3271, 3, [2, 3, 5, 109]), (4931, 6, [2, 5, 17, 29]),
        (2232195821, 2, [2, 5, 149, 229, 3271]),
        (641705627692363301, 2, [2, 5, 11, 53, 4931, 2232195821])]
  · pratt builder
      [2, 3, 5, 7, 11, 41, 67, 71, (401, 3, [2, 5]), (1723, 3, [2, 3, 7, 41]),
        (7237, 2, [2, 3, 67]), (28949, 2, [2, 7237]), (455537, 3, [2, 71, 401]),
        (1273757, 2, [2, 11, 28949]), (7642543, 3, [2, 3, 1273757]),
        (659841324290312231, 7, [2, 5, 11, 1723, 455537, 7642543])]
  · pratt builder
      [2, 3, 5, 11, 17, 37, 53, 97, (107, 2, [2, 53]), (307, 5, [2, 3, 17]),
        (7919, 7, [2, 37, 107]), (168851, 6, [2, 5, 11, 307]), (3039319, 15, [2, 3, 168851]),
        (194577202381, 2, [2, 3, 5, 11, 97, 3039319]),
        (677977020888261161, 6, [2, 5, 11, 7919, 194577202381])]
  · pratt builder
      [2, 3, 5, 7, 11, 13, 17, 83, (101, 2, [2, 5]), (103, 5, [2, 3, 17]), (211, 2, [2, 3, 5, 7]),
        (421, 2, [2, 3, 5, 7]), (607, 3, [2, 3, 101]), (43889, 3, [2, 13, 211]),
        (375127, 6, [2, 3, 103, 607]), (696112717486210091, 2, [2, 5, 11, 83, 421, 43889, 375127])]

example : ∃ n k, 0 < n ∧ ∀ i < 27, Nat.Prime (k + n * i) := by
  use 18135696597948930, 224584605939537911, by simp
  exact green_tao_27

example : Nat.Prime 1871326486211461011031931945323874719289347729538762174157135451276879 := by
  pratt
    builder
      [2, 3, 5, 7, 11, 13, 17, 19, 29, 41, 43, 47, 83, 89, (113, 3, [2, 7]), (137, 3, [2, 17]),
        (173, 2, [2, 43]), (179, 2, [2, 89]), (193, 5, [2, 3]), (359, 7, [2, 179]),
        (443, 2, [2, 13, 17]), (463, 3, [2, 3, 7, 11]), (613, 2, [2, 3, 17]), (701, 2, [2, 5, 7]),
        (719, 11, [2, 359]), (761, 6, [2, 5, 19]), (773, 2, [2, 193]), (1439, 7, [2, 719]),
        (1523, 2, [2, 761]), (2879, 7, [2, 1439]), (5557, 2, [2, 3, 463]), (11519, 7, [2, 13, 443]),
        (22433, 3, [2, 701]), (27799, 7, [2, 3, 41, 113]), (212099, 2, [2, 173, 613]),
        (977359, 3, [2, 3, 29, 41, 137]), (3255877, 2, [2, 3, 13, 773]),
        (4447841, 3, [2, 5, 27799]), (15573689, 3, [2, 13, 11519]),
        (93323561, 3, [2, 5, 11, 212099]), (311473781, 2, [2, 5, 15573689]),
        (433314067369, 11, [2, 3, 7, 13, 29, 977359]),
        (53539802496967, 5, [2, 3, 47, 1523, 5557, 22433]),
        (336828023987944771, 2, [2, 3, 5, 2879, 433314067369]),
        (2414990925857902095950321353657774391, 43, [2, 5, 3255877, 4447841, 311473781,
          53539802496967]),
        (308651819811240699707531581076318075717983737694501, 2, [2, 3, 5, 11, 83, 93323561,
          2414990925857902095950321353657774391]),
        (1871326486211461011031931945323874719289347729538762174157135451276879, 3, [2, 3,
          336828023987944771, 308651819811240699707531581076318075717983737694501])]
